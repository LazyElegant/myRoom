<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cm.dao.GoodsDao">

    <insert id="insertGoods">
         insert into `goods`
         values (#{id},#{name},#{classifyId},#{sellerId},#{content},#{registrationDate},#{imgUrl},#{original},#{current})
    </insert>

    <select id="listGoods" resultType="com.cm.vo.GoodsVo">
        select
            g.id,
            g.`name`,
            c.`name` 'classify',
            u.username 'seller',
            g.content,
            g.img_url 'imgUrl'
        from `goods` g
        LEFT JOIN `classify` c ON c.id = g.classify_id
        LEFT JOIN `user` u on u.id = g.seller_id
        where  g.seller_id = #{id}
    </select>

    <select id="getGoods" resultType="com.cm.vo.UpdateGoodsVo">
        select
            g.id,
            g.`name`,
            c.id 'classifyId',
            c.`name` 'classify',
            g.img_url 'imgUrl',
            g.original,
            g.current,
            g.content
        from `goods` g
        LEFT JOIN `classify` c ON c.id = g.classify_id
        where  g.id = #{id}
    </select>

    <select id="listIndexGoods" resultType="com.cm.vo.IndexGoodsVo">
        select
            g.id,
            g.`name`,
            c.`name` 'classify',
            u.username 'seller',
            g.content,
            g.img_url 'imgUrl',
            g.original,
            g.current
        from `goods` g
        LEFT JOIN `classify` c ON c.id = g.classify_id
        LEFT JOIN `user` u on u.id = g.seller_id
        limit 0,4;
    </select>

    <select id="listAllGoods" resultType="com.cm.vo.IndexGoodsVo">
        select
            g.id,
            g.`name`,
            c.`name` 'classify',
            u.username 'seller',
            g.content,
            g.img_url 'imgUrl',
            g.original,
            g.current
        from `goods` g
        LEFT JOIN `classify` c ON c.id = g.classify_id
        LEFT JOIN `user` u on u.id = g.seller_id
        LIMIT #{page},#{limit}
    </select>


    <select id="getAllGoodsNum" resultType="Integer">
        select
            COUNT(*)
        from `goods` g
        LEFT JOIN `classify` c ON c.id = g.classify_id
        LEFT JOIN `user` u on u.id = g.seller_id
    </select>

    <select id="getGoodsNum" resultType="Integer">
        select
            COUNT(*)
        from `goods` g
        LEFT JOIN `classify` c ON c.id = g.classify_id
        LEFT JOIN `user` u on u.id = g.seller_id
        where g.classify_id = #{id}
    </select>

    <select id="listGoodsByClass" resultType="com.cm.vo.IndexGoodsVo">
        select
            g.id,
            g.`name`,
            c.`name` 'classify',
            u.username 'seller',
            g.content,
            g.img_url 'imgUrl',
            g.original,
            g.current
        from `goods` g
        LEFT JOIN `classify` c ON c.id = g.classify_id
        LEFT JOIN `user` u on u.id = g.seller_id
        where g.classify_id = #{id}
        LIMIT #{page},#{limit}
    </select>

    <delete id="deleteGoods">
        delete from `goods` where  id = #{id}
    </delete>

    <update id="updateGoods">
        update `goods` set `name` = #{name},classify_id = #{classifyId},content=#{content},
        original=#{original},`current` = #{current} where id=#{id}
    </update>
</mapper>